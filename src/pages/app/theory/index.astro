---
import AppLayout from "@/layouts/AppLayout.astro";
import TenseGrid from "@/components/theory/TenseGrid.astro";
import { TenseCard } from "@/components/theory/TenseCard";
import { getCollection } from "astro:content";
import { getTenseIcon } from "@/lib/theory-utils";
import type { TenseCardData } from "@/types";

// Load theory entries from content collection
const theoryEntries = await getCollection("theory");

// Map entries to TenseCardData and sort by order
const tenseData: TenseCardData[] = theoryEntries
  .sort((a, b) => a.data.order - b.data.order)
  .map((entry) => ({
    name: entry.data.tense,
    slug: entry.slug,
    description: entry.data.description,
    icon: getTenseIcon(entry.data.tense),
  }));
---

<AppLayout title="Theory - TenseAI">
  <div class="max-w-6xl mx-auto">
    <header class="mb-8">
      <h1 class="text-3xl font-bold tracking-tight mb-2">Theory</h1>
      <p class="text-lg text-muted-foreground">
        Learn about English grammar tenses - understand when to use them, how to construct sentences, and common time
        expressions.
      </p>
    </header>

    <TenseGrid>
      {
        tenseData.map((tense) => (
          <TenseCard
            name={tense.name}
            slug={tense.slug}
            description={tense.description}
            icon={tense.icon}
            client:load
          />
        ))
      }
    </TenseGrid>
  </div>
</AppLayout>
